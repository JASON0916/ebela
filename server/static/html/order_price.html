<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <title>订单数据</title>
    <link href="/static/css/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/bootstrap/css/bootstrap-datepicker.min.css" rel="stylesheet">
    <link href="/static/css/base.css" rel="stylesheet">
  </head>
  <body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand">订单数据</a>
        </div>
      </div><!-- /.container-fluid -->
    </nav>

    <div class="container">
      <div class = "row">
      <!-- 查询框 -->
        <div class = "col-md-12">
          <form class="form-inline">
            <div class="query-group form-group">
              <label for="sdate">时间:</label>
              <input type="text" class="form-date" id="start-date" name="sdate" > -
              <input type="text" class="form-date" id="end-date"  name="edate" >
            </div>

            <div class = "query-group form-group">
              <div class="btn-group" data-toggle="buttons">
                <label class="btn btn-default active">
                  <input type="radio" name="period" value=0 checked>按日
                </label>
                <label class="btn btn-default">
                  <input type="radio" name="period" value=1>按周
                </label>
              </div>
            </div>
            <div class = "query-group form-group">
              <label for="user_type">用户类型:</label>
              <label class="checkbox-inline">
                <input type="checkbox" name="user_type" id="new_user" checked> 新用户
              </label>
              <label class="checkbox-inline">
                <input type="checkbox" name="user_type" id="old_user" checked> 老用户
              </label>
            </div>
            <div class = "query-group form-group">
              <button type="button" class="btn btn-default" id="search">查询</button>
            </div>
          </form>
        </div>
      </div>

      <div class = "col-md-12 query-group">
      <!-- 表格 -->
        <table class="table table-bordered table-striped table-hover table-condensed">
          <thead class="thead-inverse">
            <tr class="info">
              <th>时间</th>
              <th>用户数</th>
              <th>用户占比(%)</th>
              <th>原价</th>
              <th>售价</th>
              <th>实付价</th>
              <th>立减优惠金额</th>
              <th>立减优惠力度(%)</th>
              <th>红包优惠金额</th>
              <th>红包优惠力度(%)</th>
              <th>预定天数</th>
              <th>日单份数</th>
              <th>日单原价</th>
              <th>日单售价</th>
              <th>日单实付价</th>
              <th>用户复购率(%)</th>
              <th>用户回购率(%)</th>
            </tr>
          </thead>
          <tbody id="user_info_table">
          </tbody>
        </table>
      </div>
    <div class = "query-group form-group">
        <ul class="pager">
            <li><a href="javascript:void(0);" id="firstPage">«首页</a></li>
            <li><a href="javascript:void(0);" id="prevPage">上一页</a></li>
            <li><a href="javascript:void(0);" id="nextPage">下一页</a></li>
            <li><a href="javascript:void(0);" id="lastPage">末页»</a></li>

            <li>共<lable id="totalPage"></lable>页
            </li>
            <li>第<lable id="currentPage"></lable>页
            </li>
            <li>共<lable id="totalRows"></lable>条记录
            </li>
        </ul>
    </div>
    </div>

    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap/bootstrap.min.js"></script>
    <script src="/static/js/bootstrap/bootstrap-datepicker.min.js"></script>
    <script src="/static/js/bootstrap/bootstrap-datepicker.zh-CN.min.js"></script>
    <script>
        function getFormatedDate(deltaDays) {
            if (deltaDays == null) deltaDays = 0;

            var date = new Date();
            date.setDate(date.getDate() + deltaDays)
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();

            if (month < 10) month = "0" + month;
            if (day < 10) day = "0" + day;

            return year + "-" + month + "-" + day;
        }

        jQuery(document).ready(function($) {
            $("#start-date").datepicker("setDate", getFormatedDate(-7));
            $("#end-date").datepicker("setDate", getFormatedDate(-1));
        });

        $('#start-date').datepicker({
            language: 'zh-CN',
            format: 'yyyy-mm-dd',
            autoclose: true,
            defaultDate: -7,
            startDate: '2015-04-29',
            endDate: '-1d',
            clearBtn: true
        }).on('changeDate', function(selected) {
            var minDate = new Date(selected.date.valueOf());
            $('#end-date').datepicker('setStartDate', minDate);
            var maxDate = new Date(selected.date.valueOf());
            maxDate.setDate(maxDate.getDate()+60);
            var nowDate = $('#end-date').datepicker('getDate');
            if(maxDate < nowDate) {
                $('#end-date').datepicker('setDate', maxDate);
            }
        }).on('clearDate', function(selected) {
            var yesterday = new Date();
            yesterday.setDate(yesterday.getDate()-1);
            $('#start-date').datepicker('setEndDate', yesterday);
            $('#start-date').datepicker('setStartDate', null);
            $('#end-date').datepicker('setEndDate', yesterday);
            $('#end-date').datepicker('setStartDate', null);
        });

        $('#end-date').datepicker({
            language: 'zh-CN',
            format: 'yyyy-mm-dd',
            autoclose: true,
            defaultDate: -1,
            endDate:'-1d',
            clearBtn: true
        }).on('changeDate', function(selected) {
            var minDate = new Date(selected.date.valueOf());
            minDate.setDate(minDate.getDate()-60);

            var nowDate = $('#start-date').datepicker('getDate');
            var maxDate = new Date(selected.date.valueOf());
            if(minDate > nowDate) {
                $('#start-date').datepicker('setEndDate', maxDate);
                $('#start-date').datepicker('setDate', minDate);
            }

            var right_date = $('#end-date').datepicker('getDate');
            $('#start-date').datepicker('setEndDate', right_date);

        }).on('clearDate', function(selected) {
            var yesterday = new Date();
            yesterday.setDate(yesterday.getDate()-1);
            $('#start-date').datepicker('setEndDate', yesterday);
            $('#start-date').datepicker('setStartDate', null);
            $('#end-date').datepicker('setEndDate', yesterday);
            $('#end-date').datepicker('setStartDate', null);
        });
    </script>
    <script src="/static/js/get_user_info.js"></script>
  </body>
</html>
